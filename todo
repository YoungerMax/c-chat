error handling: assignee aodhfionn

split common across two files for unix and win32